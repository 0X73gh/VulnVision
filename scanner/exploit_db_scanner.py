import requests
from colorama import Fore

def cve_scan(service, version):
    """Checks for CVEs for a given service and version."""
    print(Fore.CYAN + f"[*] Checking CVEs for {service} {version}...")
    try:
        url = f"https://cve.circl.lu/api/search/{service}/{version}"
        response = requests.get(url)
        if response.status_code == 200 and response.json():
            for cve in response.json():
                print(Fore.YELLOW + f"  - {cve['id']}: {cve['summary']}")
        else:
            print(Fore.GREEN + "[+] No CVEs found.")
    except Exception as e:
        print(Fore.RED + f"[!] CVE check failed: {e}")
